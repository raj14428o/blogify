<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('./partials/head') %>
  <title>Verify OTP</title>

  <style>
    .otp-wrapper {
      max-width: 640px;   /* perfect width for OTP */
      width: 100%;
    }

    #email,
    #exampleInputPassword1 {
      border: 2px solid #000;
      border-radius: 6px;
    }

    #email:focus,
    #exampleInputPassword1:focus {
      border-color: #0056b3;
      box-shadow: 0 0 5px rgba(0, 86, 179, 0.5);
    }

    .resend-btn {
      background: none;
      border: none;
      color: #0d6efd;
      padding: 0;
      font-size: 0.9rem;
      cursor: pointer;
    }

    .resend-btn:disabled {
      color: #9ca3af;
      cursor: not-allowed;
    }
  </style>
</head>

<body>
  <%- include('./partials/nav') %>

  <div class="container-fluid mt-5">
    <div class="mx-auto otp-wrapper">

      <h4 class="mb-3">Verify your email</h4>

   
      <form action="/user/verify" method="post">

        <!-- Email -->
        <div class="mb-3">
          <label for="email" class="form-label">Email address</label>
          <input
            type="email"
            name="email"
            id="email"
            class="form-control"
            value="<%= email %>"
            readonly
          >
        </div>

        <!-- OTP -->
        <div class="mb-3">
          <label for="exampleInputPassword1" class="form-label">OTP</label>
          <input
            type="password"
            name="otp"
            class="form-control"
            id="exampleInputPassword1"
            placeholder="Enter OTP"
            required
          >
        </div>

        <!-- Submit -->
        <button type="submit" class="btn btn-primary w-100">
          Verify OTP
        </button>
      </form>

      <!-- Resend OTP -->
      <form action="/user/resend-otp" method="post" class="mt-3 text-center">
        <!-- âœ… FIXED: hidden email initialized immediately -->
        <input type="hidden" name="email" id="resendEmail" value="<%= email %>">
        <button type="submit" class="resend-btn">
          Resend OTP
        </button>
      </form>
    </div>
  </div>

  <%- include('./partials/scripts') %>

  <script>
    const emailInput = document.getElementById('email');
    const resendEmail = document.getElementById('resendEmail');
    if (emailInput && resendEmail) {
      resendEmail.value = emailInput.value; // initialize immediately
      emailInput.addEventListener('input', () => {
        resendEmail.value = emailInput.value;
      });
    }
  </script>
</body>
</html>
